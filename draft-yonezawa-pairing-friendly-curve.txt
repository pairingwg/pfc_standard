



Network Working Group                                        S. Yonezawa
Internet-Draft                                                   Lepidum
Intended status: Experimental                                 S. Chikara
Expires: September 12, 2019                              NTT TechnoCross
                                                            T. Kobayashi
                                                                T. Saito
                                                                     NTT
                                                          March 11, 2019


                        Pairing-Friendly Curves
               draft-yonezawa-pairing-friendly-curves-01

Abstract

   This memo introduces pairing-friendly curves used for constructing
   pairing-based cryptography.  It describes recommended parameters for
   each security level and recent implementations of pairing-friendly
   curves.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on September 12, 2019.

Copyright Notice

   Copyright (c) 2019 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (https://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must



Yonezawa, et al.       Expires September 12, 2019               [Page 1]

Internet-Draft           Pairing-Friendly Curves              March 2019


   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
     1.1.  Pairing-Based Cryptography  . . . . . . . . . . . . . . .   2
     1.2.  Applications of Pairing-Based Cryptography  . . . . . . .   3
     1.3.  Goal  . . . . . . . . . . . . . . . . . . . . . . . . . .   4
     1.4.  Requirements Terminology  . . . . . . . . . . . . . . . .   4
   2.  Preliiminaries  . . . . . . . . . . . . . . . . . . . . . . .   4
     2.1.  Elliptic Curve  . . . . . . . . . . . . . . . . . . . . .   4
     2.2.  Pairing . . . . . . . . . . . . . . . . . . . . . . . . .   5
     2.3.  Barreto-Naehrig Curve . . . . . . . . . . . . . . . . . .   5
     2.4.  Barreto-Lynn-Scott Curve  . . . . . . . . . . . . . . . .   6
   3.  Security of Pairing-Friendly Curves . . . . . . . . . . . . .   7
     3.1.  Evaluating the Security of Pairing-Friendly Curves  . . .   7
     3.2.  Impact of the Recent Attack . . . . . . . . . . . . . . .   7
   4.  Security Evaluation of Pairing-Friendly Curves  . . . . . . .   8
     4.1.  For 100 Bits of Security  . . . . . . . . . . . . . . . .   8
     4.2.  For 128 Bits of Security  . . . . . . . . . . . . . . . .   9
     4.3.  For 256 Bits of Security  . . . . . . . . . . . . . . . .  11
   5.  Implementations of Pairing-Friendly Curves  . . . . . . . . .  13
   6.  Security Considerations . . . . . . . . . . . . . . . . . . .  16
   7.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  16
   8.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .  16
   9.  Change log  . . . . . . . . . . . . . . . . . . . . . . . . .  16
   10. References  . . . . . . . . . . . . . . . . . . . . . . . . .  16
     10.1.  Normative References . . . . . . . . . . . . . . . . . .  16
     10.2.  Informative References . . . . . . . . . . . . . . . . .  17
   Appendix A.  Computing Optimal Ate Pairing  . . . . . . . . . . .  20
     A.1.  Optimal Ate Pairings over Barreto-Naehrig Curves  . . . .  21
     A.2.  Optimal Ate Pairings over Barreto-Lynn-Scott Curves . . .  21
   Appendix B.  Test Vectors of Optimal Ate Pairing  . . . . . . . .  22
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  26

1.  Introduction

1.1.  Pairing-Based Cryptography

   Elliptic curve cryptography is one of the important areas in recent
   cryptography.  The cryptographic algorithms based on elliptic curve
   cryptography, such as ECDSA, is widely used in many applications.

   Pairing-based cryptography, a variant of elliptic curve cryptography,
   is attracted the attention for its flexible and applicable
   functionality.  Pairing is a special map defined over elliptic



Yonezawa, et al.       Expires September 12, 2019               [Page 2]

Internet-Draft           Pairing-Friendly Curves              March 2019


   curves.  As the importance of pairing grows, elliptic curves where
   pairing is efficiently computable are studied and the special curves
   called pairing-friendly curves are proposed.

   Thanks to the characteristics of pairing, it can be applied to
   construct several cryptographic algorithms and protocols such as
   identity-based encryption (IBE), attribute-based encryption (ABE),
   authenticated key exchange (AKE), short signatures and so on.
   Several applications of pairing-based cryptography is now in
   practical use.

1.2.  Applications of Pairing-Based Cryptography

   Several applications using pairing-based cryptography are
   standardized and implemented.  We show example applications available
   in the real world.

   IETF issues RFCs for pairing-based cryptography such as identity-
   based cryptography [9],
   Sakai-Kasahara Key Encryption (SAKKE) [10], and Identity-Based
   Authenticated Key Exchange (IBAKE) [11].  SAKKE is applied to
   Multimedia Internet KEYing (MIKEY) [12] and used in 3GPP [13].

   Pairing-based key agreement protocols are standardized in ISO/IEC
   [14].  In [14], a key agreement scheme by Joux [15], identity-based
   key agreement schemes by Smart-Chen-Cheng [16] and by Fujioka-Suzuki-
   Ustaoglu [17] are specified.

   MIRACL implements M-Pin, a multi-factor authentication protocol [18].
   M-Pin protocol includes a kind of zero-knowledge proof, where pairing
   is used for its construction.

   Trusted Computing Group (TCG) specifies ECDAA (Elliptic Curve Direct
   Anonymous Attestation) in the specification of Trusted Platform
   Module (TPM) [19].  ECDAA is a protocol for proving the attestation
   held by a TPM to a verifier without revealing the attestation held by
   that TPM.  Pairing is used for constructing ECDAA.  FIDO Alliance
   [20] and W3C [21] also published ECDAA algorithm similar to TCG.

   Zcash implements their own zero-knowledge proof algorithm named zk-
   SNARKs (Zero-Knowledge Succinct Non-Interactive Argument of
   Knowledge) [22]. zk-SNARKs is used for protecting privacy of
   transactions of Zcash.  They use pairing for constructing zk-SNARKS.

   Cloudflare introduced Geo Key Manager [23] to restrict distribution
   of customers' private keys to the subset of their data centers.  To
   achieve this functionality, attribute-based encryption is used and
   pairing takes a role as a building block.



Yonezawa, et al.       Expires September 12, 2019               [Page 3]

Internet-Draft           Pairing-Friendly Curves              March 2019


   DFINITY utilized threshold signature scheme to generate the
   decentralized random beacons [24].  They constructed a BLS signature-
   based scheme, which is based on pairings.

   In Ethereum 2.0, project Prysm applies signature aggregation for
   scalability benefits by leveraging DFINITY's random-beacon chain
   playground [25].  Their codes are published on GitHub.

1.3.  Goal

   The goal of this memo is to consider the security of pairing-friendly
   curves used in pairing-based cryptography and introduce secure
   parameters of pairing-frindly curves.  Specifically, we explain the
   recent attack against pairing-friendly curves and how much the
   security of the curves is reduced.  We show how to evaluate the
   security of pairing-friendly curves and give the parameters for 100
   bits of security, which is no longer secure, 128 and 256 bits of
   security.

1.4.  Requirements Terminology

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED",
   "MAY", and "OPTIONAL" in this document are to be interpreted as
   described in [1].

2.  Preliiminaries

2.1.  Elliptic Curve

   Let p > 3 be a prime and F_p be a finite field.  The curve defined by
   the following equation E is called an elliptic curve.

     E : y^2 = x^3 + A * x + B,
     where A, B are in F\_p and satisfies 4 * A^3 + 27 * B^2 != 0 mod p.

   Solutions (x, y) for an elliptic curve E, as well as the point at
   infinity, O_E, are called F_p-rational points.  If P and Q are two
   points on the curve E, we can define R = P + Q as the opposite point
   of the intersection between the curve E and the line that intersects
   P and Q.  We can define P + O_E = P = O_E + P as well.  The additive
   group is constructed by the well-defined operation in the set of F_p-
   rational points.  Similarly, a scalar multiplication S = [a]P for a
   positive integer a can be defined as an a-time addition of P.

   Typically, the cyclic additive group with a prime order r and the
   base point G in its group is used for the elliptic curve




Yonezawa, et al.       Expires September 12, 2019               [Page 4]

Internet-Draft           Pairing-Friendly Curves              March 2019


   cryptography.  Furthermore, we define terminology used in this memo
   as follows.

   O_E:  the point at infinity over an elliptic curve E.

   #E(F_p):  number of points on an elliptic curve E over F_p.

   h: a cofactor such that h = #E(F_p)/r.

   k: an embedding degree, a minimum integer such that r is a divisor of
      p^k - 1.

2.2.  Pairing

   Pairing is a kind of the bilinear map defined over an elliptic curve.
   Examples include Weil pairing, Tate pairing, optimal Ate pairing [2]
   and so on.  Especially, optimal Ate pairing is considered to be
   efficient to compute and mainly used for practical implementation.

   Let E be an elliptic curve defined over the prime field F_p.  Let G_1
   be a cyclic subgroup generated by a rational point on E with order r,
   and G_2 be a cyclic subgroup generated by a twisted curve E' of E
   with order r.  Let G_T be an order r subgroup of a field F_p^k, where
   k is an embedded degree.  Pairing is defined as a bilinear map e:
   (G_1, G_2) -> G_T satisfying the following properties:

   1.  Bilinearity: for any S in G_1, T in G_2, a, b in Z_r, we have the
       relation e([a]S, [b]T) = e(S, T)^{a * b}.

   2.  Non-degeneracy: for any T in G_2, e(S, T) = 1 if and only if S =
       O_E.  Similarly, for any S in G_1, e(S, T) = 1 if and only if T =
       O_E.

   3.  Computability: for any S in G_1 and T in G_2, the bilinear map is
       efficiently computable.

2.3.  Barreto-Naehrig Curve

   A BN curve [3] is one of the instantiations of pairing-friendly
   curves proposed in 2005.  A pairing over BN curves constructs optimal
   Ate pairings.

   A BN curve is an elliptic curve E defined over a finite field F_p,
   where p is more than or equal to 5, such that p and its order r are
   prime numbers parameterized by

      p = 36u^4 + 36u^3 + 24u^2 + 6u + 1
      r = 36u^4 + 36u^3 + 18u^2 + 6u + 1



Yonezawa, et al.       Expires September 12, 2019               [Page 5]

Internet-Draft           Pairing-Friendly Curves              March 2019


   for some well chosen integer u.  The elliptic curve has an equation
   of the form E: y^2 = x^3 + b, where b is an element of multiplicative
   group of order p.

   BN curves always have order 6 twists.  If w is an element which is
   neither a square nor a cube in a finite field F_p^2, the twisted
   curve E' of E is defined over a finite field F_p^2 by the equation
   E': y^2 = x^3 + b' with b' = b/w or b' = bw.  The embedded degree k
   is 12.

   A pairing e is defined by taking G_1 as a cyclic group composed by
   rational points on the elliptic curve E, G_2 as a cyclic group
   composed by rational points on the elliptic curve E', and G_T as a
   multiplicative group of order p^12.

2.4.  Barreto-Lynn-Scott Curve

   A BLS curve [4] is another instantiations of pairings proposed in
   2002.  Similar to BN curves, a pairing over BLS curves constructs
   optimal Ate pairings.

   A BLS curve is an elliptic curve E defined over a finite field F_p by
   an equation of the form E: y^2 = x^3 + b and has a twist of order 6
   defined in the same way as BN curves.  In contrast to BN curves, a
   BLS curve does not have a prime order but its order is divisible by a
   large parameterized prime r and the pairing will be defined on the
   r-torsions points.

   BLS curves vary according to different embedding degrees.  In this
   memo, we deal with BLS12 and BLS48 families with embedding degrees 12
   and 48 with respect to r, respectively.

   In BLS curves, parameterized p and r are given by the following
   equations:

      BLS12:
          p = (u - 1)^2 * (u^4 - u^2 + 1) / 3 + u
          r = u^4 - u^2 + 1
      BLS48:
          p = (u - 1)^2 * (u^16 - u^8 + 1) / 3 + u
          r = u^16 - u^8 + 1

   for some well chosen integer u.








Yonezawa, et al.       Expires September 12, 2019               [Page 6]

Internet-Draft           Pairing-Friendly Curves              March 2019


3.  Security of Pairing-Friendly Curves

3.1.  Evaluating the Security of Pairing-Friendly Curves

   The security of pairing-friendly curves is evaluated by the hardness
   of the following discrete logarithm problems.

   -  The elliptic curve discrete logarithm problem (ECDLP) in G_1 and
      G_2

   -  The finite field discrete logarithm problem (FFDLP) in G_T

   There are other hard problems over pairing-friendly curves, which are
   used for proving the security of pairing-based cryptography.  Such
   problems include computational bilinear Diffie-Hellman (CBDH) problem
   or bilinear Diffie-Hellman (BDH) Problem, decision bilinear Diffie-
   Hellman (DBDH) problem, gap DBDH problem, etc [26].  Almost all of
   these variants are reduced to the hardness of discrete logarithm
   problems described above and believed to be easier than the discrete
   logarithm problems.

   There would be the case where the attacker solves these reduced
   problems to break the pairing-based cryptography.  Since such attacks
   have not been discovered yet, we discuss the hardness of the discrete
   logarithm problems in this memo.

   The security level of pairing-friendly curves is estimated by the
   computational cost of the most efficient algorithm to solve the above
   discrete logarithm problems.  The well-known algorithms for solving
   the discrete logarithm problems includes Pollard's rho algorithm
   [27], Index Calculus [28] and so on.  In order to make index calculus
   algorithms more efficient, number field sieve (NFS) algorithms are
   utilized.

   In addition, the special case where the cofactors of G_1, G_2 and G_T
   are small should be taken care [29].  In such case, the discrete
   logarithm problem can be efficiently solved.  One has to choose
   parameters so that the cofactors of G_1, G_2 and G_T contain no prime
   factors smaller than |G_1|, |G_2| and |G_T|.

3.2.  Impact of the Recent Attack

   In 2016, Kim and Barbulescu proposed a new variant of the NFS
   algorithms, the extended number field sieve (exTNFS), which
   drastically reduces the complexity of solving FFDLP [5].  Due to
   exTNFS, the security level of pairing-friendly curves asymptotically
   dropped down.  For instance, Barbulescu and Duquesne estimates that
   the security of the BN curves which was believed to provide 128 bits



Yonezawa, et al.       Expires September 12, 2019               [Page 7]

Internet-Draft           Pairing-Friendly Curves              March 2019


   of security (BN256, for example) dropped down to approximately 100
   bits [6].

   Some papers show the minimum bitlength of the parameters of pairing-
   friendly curves for each security level when applying exTNFS as an
   attacking method for FFDLP.  For 128 bits of security, Menezes,
   Sarkar and Singh estimated the minimum bitlength of p of BN curves
   after exTNFS as 383 bits, and that of BLS12 curves as 384 bits [7].
   For 256 bits of security, Kiyomura et al. estimated the minimum
   bitlength of p^k of BLS48 curves as 27,410 bits, which implied 572
   bits of p [8].

4.  Security Evaluation of Pairing-Friendly Curves

   We give security evaluation for pairing-friendly curves based on the
   evaluating method presented in Section 3.  We also introduce secure
   parameters of pairing-friendly curves for each security level.  The
   parameters introduced here are chosen with the consideration of
   security, efficiency and global acceptance.

   For security, we introduce 100 bits, 128 bits and 256 bits of
   security.  We note that 100 bits of security is no longer secure and
   recommend 128 bits and 256 bits of security for secure applications.
   We follow TLS 1.3 which specifies the cipher suites with 128 bits and
   256 bits of security as mandatory-to-implement for the choice of the
   security level.

   Implementors of the applications have to choose the parameters with
   appropriate security level according to the security requirements of
   the applications.  For efficiency, we refer to the benchmark by mcl
   [30] for 128 bits of security, and by Kiyomura et al. [8] for 256
   bits of security and choose sufficiently efficient parameters.  For
   global acceptance, we give the implementations of pairing-friendly
   curves in Section 5.

4.1.  For 100 Bits of Security

   Before exTNFS, BN curves with 256-bit size of underlying finite field
   (so-called BN256) were considered to have 128 bits of security.
   After exTNFS, however, the security level of BN curves with 256-bit
   size of underlying finite field fell into 100 bits.

   Implementors who will newly develop the applications of pairing-based
   cryptography SHOULD NOT use BN256 as a pairing-friendly curve when
   their applications require 128 bits of security.  In case an
   application does not require higher security level and is sufficient
   to have 100 bits of security (i.e.  IoT), implementors MAY use BN256.




Yonezawa, et al.       Expires September 12, 2019               [Page 8]

Internet-Draft           Pairing-Friendly Curves              March 2019


4.2.  For 128 Bits of Security

   A BN curve with 128 bits of security is shown in [6], which we call
   BN462.  BN462 is defined by a parameter u = 2^114 + 2^101 - 2^14 - 1
   for the definition in Section 2.3.  Defined by u, the elliptic curve
   E and its twisted curve E' are represented by E: y^2 = x^3 - 4 and
   E': y^2 = x^3 - 4 * (1 + i), where i is an element of an extension
   field F_p^2, respectively.  The size of p becomes 462-bit length.

   As the parameters for BN462, we give a characteristic p, an order r,
   a base point G = (x, y), a cofactor h of an elliptic curve E: y^2 =
   x^3 + b, and an order r', a base point G' = (x', y'), a cofactor h'
   of an elliptic curve E': y-2 = x^3 + b'.  In order to represent G' =
   (x', y') in an extension field, we adopt the representation
   convention in [31], that is, for x' = x'_1 * w + x'_2 for an
   indeterminant w, we encode x' as x' = x'_1 * p + x'_2.

   p: 0x2404 80360120 023FFFFF FFFFF6FF 0CF6B7D9 BFCA0000 000000D8
      12908F41 C8020FFF FFFFFFF6 FF66FC6F F687F640 00000000 2401B008
      40138013

   r: 0x2404 80360120 023FFFFF FFFFF6FF 0CF6B7D9 BFCA0000 000000D8
      12908EE1 C201F7FF FFFFFFF6 FF66FC7B F717F7C0 00000000 2401B007
      E010800D

   x: 0x21a6 d67ef250 191fadba 34a0a301 60b9ac92 64b6f95f 63b3edbe
      c3cf4b2e 689db1bb b4e69a41 6a0b1e79 239c0372 e5cd7011 3c98d91f
      36b6980d

   y: 0x0118 ea0460f7 f7abb82b 33676a74 32a490ee da842ccc fa7d788c
      65965042 6e6af77d f11b8ae4 0eb80f47 5432c666 00622eca a8a5734d
      36fb03de

   h: 1

   b: 5

   r':  0x2404 80360120 023FFFFF FFFFF6FF 0CF6B7D9 BFCA0000 000000D8
      12908EE1 C201F7FF FFFFFFF6 FF66FC7B F717F7C0 00000000 2401B007
      E010800D

   x':  0x041b04cb e3413297 c49d8129 7eed0759 47d86135 c4abf0be 9d5b64be
      02d6ae78 34047ea4 079cd30f e28a68ba 0cb8f7b7 2836437d c75b2567
      ff2b98db b93f68fa c828d822 1e4e1d89 475e2d85 f2063cbc 4a74f6f6
      6268b6e6 da1162ee 055365bb 30283bde 614a17f6 1a255d68 82417164
      bc500498





Yonezawa, et al.       Expires September 12, 2019               [Page 9]

Internet-Draft           Pairing-Friendly Curves              March 2019


   y':  0x0104fa79 6cbc2989 0f9a3798 2c353da1 3b299391 be45ddb1 c15ca42a
      bdf8bf50 2a5dd7ac 0a3d351a 859980e8 9be676d0 0e92c128 714d6f3c
      6aba56ca 6e0fc6a5 468c12d4 2762b29d 840f13ce 5c3323ff 016233ec
      7d76d4a8 12e25bbe b2c25024 3f2cbd27 80527ec5 ad208d72 24334db3
      c1b4a49c

   h':  0x2404 80360120 023fffff fffff6ff 0cf6b7d9 bfca0000 000000d8
      12908fa1 ce0227ff fffffff6 ff66fc63 f5f7f4c0 00000000 2401b008
      a0168019

   b':  -u + 2

   A BLS12 curve with 128 bits of security shown in [32], BLS12-381, is
   defined by a parameter u = -2^63 - 2^62 - 2^60 - 2^57 - 2^48 - 2^16
   and the size of p becomes 381-bit length.  Defined by u, the elliptic
   curve E and its twisted curve E' are represented by E: y^2 = x^3 + 4
   and E': y^2 = x^3 + 4(i + 1), respectively.

   We have to note that, according to [7], the bit length of p for BLS12
   to achieve 128 bits of security is calculated as 384 bits and more,
   which BLS12-381 does not satisfy.  Although the computational time is
   conservatively estimated by 2^110 when exTNFS is applied with index
   calculus, there is no currently published efficient method for such
   computational time.  They state that BLS12-381 achieves 127-bit
   security level evaluated by the computational cost of Pollard's rho.
   Therefore, we regard BN462 as a "conservative" parameter, and
   BLS12-381 as an "optimistic" parameter.

   We give the parameters for BLS12-381 as follows.

   p: 0x1a0111ea 397fe69a 4b1ba7b6 434bacd7 64774b84 f38512bf 6730d2a0
      f6b0f624 1eabfffe b153ffff b9feffff ffffaaab

   r: 0x73eda753 299d7d48 3339d808 09a1d805 53bda402 fffe5bfe ffffffff
      00000001

   x: 0x17F1D3A7 3197D794 2695638C 4FA9AC0F C3688C4F 9774B905 A14E3A3F
      171BAC58 6C55E83F F97A1AEF FB3AF00A DB22C6BB

   y: 0x08B3F481 E3AAA0F1 A09E30ED 741D8AE4 FCF5E095 D5D00AF6 00DB18CB
      2C04B3ED D03CC744 A2888AE4 0CAA2329 46C5E7E1

   h: 0x396C8C00 5555E156 8C00AAAB 0000AAAB

   b: 4

   r':  0x1a0111ea 397fe69a 4b1ba7b6 434bacd7 64774b84 f38512bf 6730d2a0
      f6b0f624 1eabfffe b153ffff b9feffff ffffaaab



Yonezawa, et al.       Expires September 12, 2019              [Page 10]

Internet-Draft           Pairing-Friendly Curves              March 2019


   x':  0x204D9AC 05FFBFEB AC60C8F3 E4143831 567C7063 D38B0595 9C12EC06
      3FD7B99A B4541ECE FAA3F0EC 1A0A33DA 0FF56D7B 45B2CA9F F8ADBAC4
      78790D52 DC45216B 3E272DCE A7571E71 81B20335 695608A3 0EA1F83E
      53A80D95 AD3A0C1E 7C4E76E2

   y':  0x09CB66A FFF60C18 9DA2C655 D4ECCAD1 5DBA53E8 A3C89101 ABA0838C
      17AD69CD 096844BA 7EC246EA 99BE5C24 9AEA2F05 C14385E9 C53DF5FB
      63DDECFE F1067E73 5CC17763 97138D4C B2CCDFBE 45B5343E EADF6637
      08AE1288 AA4306DB 8598A5EB

   h':  0x5D543A9 5414E7F1 091D5079 2876A202 CD91DE45 47085ABA A68A205B
      2E5A7DDF A628F1CB 4D9E82EF 21537E29 3A6691AE 1616EC6E 786F0C70
      CF1C38E3 1C7238E5

   b':  4 * (i + 1)

4.3.  For 256 Bits of Security

   As shown in Section 3.2, it is unrealistic to achieve 256 bits of
   security by BN curves since the minimum size of p becomes too large
   to implement.  Hence, we consider BLS48 for 256 bits of security.

   A BLS48 curve with 256 bits of security is shown in [8], which we
   call BLS48-581.  It is defined by a parameter u = -1 + 2^7 - 2^10 -
   2^30 - 2^32 and the elliptic curve E and its twisted curve E' are
   represented by E: y^2 = x^3 + 1 and E': y^2 = x^3 - 1 / w, where w is
   an element of an extension field F_p^8.  The size of p becomes
   581-bit length.

   We then give the parameters for BLS48-581.  Here, a base point (x',
   y') in an extension field of order 12 is represented as follows: for
   x' = x'_0 + x'_1 * i + x'_2 * i^2 + ... + x'_{11} * i^{11} and y' =
   y'_0 + y'_1 * i + y'_2 * i^2 + ... + y'_{11} * i^{11}, x' and y' are
   represented by

      x' = x'\_0 + x'\_1 \* p + x'\_2 \* p^2 + ... + x'\_{11} \* p^{11},
      y' = y'\_0 + y'\_1 \* p + y'\_2 \* p^2 + ... + y'\_{11} \* p^{11}.

   p: 0x12 80F73FF3 476F3138 24E31D47 012A0056 E84F8D12 2131BB3B
      E6C0F1F3 975444A4 8AE43AF6 E082ACD9 CD30394F 4736DAF6 8367A551
      3170EE0A 578FDF72 1A4A48AC 3EDC154E 6565912B

   r: 0x23 86f8a925 e2885e23 3a9ccc16 15c0d6c6 35387a3f 0b3cbe00
      3fad6bc9 72c2e6e7 41969d34 c4c92016 a85c7cd0 562303c4 ccbe5994
      67c24da1 18a5fe6f cd671c01






Yonezawa, et al.       Expires September 12, 2019              [Page 11]

Internet-Draft           Pairing-Friendly Curves              March 2019


   x: 0x02 af59b7ac 340f2baf 2b73df1e 93f860de 3f257e0e 86868cf6
      1abdbaed ffb9f754 4550546a 9df6f964 5847665d 859236eb dbc57db3
      68b11786 cb74da5d 3a1e6d8c 3bce8732 315af640

   y: 0x0c efda44f6 531f91f8 6b3a2d1f b398a488 a553c9ef eb8a52e9
      91279dd4 1b720ef7 bb7beffb 98aee53e 80f67858 4c3ef22f 487f77c2
      876d1b2e 35f37aef 7b926b57 6dbb5de3 e2587a70

   h: 0x85555841 aaaec4ac

   b: 1

   r':  0x23 86f8a925 e2885e23 3a9ccc16 15c0d6c6 35387a3f 0b3cbe00
      3fad6bc9 72c2e6e7 41969d34 c4c92016 a85c7cd0 562303c4 ccbe5994
      67c24da1 18a5fe6f cd671c01

   x':  0x01 690ae060 61530e31 64040ce6 e7466974 a0865edb 6d5b825d
      f11e5db6 b724681c 2b5a805a f2c7c45f 60300c3c 4238a1f5 f6d3b644
      29f5b655 a4709a8b ddf790ec 477b5fb1 ed4a0156 dec43f7f 6c401164
      da6b6f9a f79b9fc2 c0e09d2c d4b65900 d2394b61 aa3bb48c 7c731a14
      68de0a17 346e34e1 7d58d870 7f845fac e35202bb 9d64b5ef f29cbfc8
      5f5c6d60 1d794c87 96c20e67 81dffed3 36fc1ff6 d3ae3193 dec00603
      91acb681 1f1fbde3 8027a0ef 591e6b21 c6e31c5f 1fda66eb 05582b6b
      0399c6a2 459cb2ab fd0d5d95 3447a927 86e194b2 89588e63 ef1b8b61
      ad354bed 299b5a49 7c549d7a 56a74879 b7665a70 42fbcaf1 190d915f
      945fef6c 0fcec14b 4afc403f 50774720 4d810c57 00de1692 6309352f
      660f26a5 529a2f74 cb9d1044 0595dc25 d6d12fcc e84fc565 57217bd4
      bc2d645a b4ca167f b812de7c acc3b942 7fc78212 985680b8 83bf7fee
      7eae0199 1eb7a52a 0f4cbb01 f5a8e3c1 6c41350d c62be2c1 9cbd2b98
      d9c9d268 7cd811db 7863779c 97e9a15b d6967d5e b21f972d 28ad9d43
      7de41234 25249319 98f280a9 a9c799c3 3ff8f838 ca35bdde bbb79cdc
      2967946c c0f77995 411692e1 8519243d 5598bdb4 623a11dc 97ca3889
      49f32c65 db3fc6a4 7124bd5d 063549e5 0b0f8b03 0d3a9830 e1e3bef5
      cd428393 9d33a28c fdc3df89 640df257 c0fc2544 77a9c8ef f69b57cf
      f042e6fd 1ef3e293 c57beca2 cd61dc44 838014c2 08eda095 e10d5e89
      e705ff69 07047895 96e41969 96508797 71f58935 d768cdc3 b55150cc
      a3693e28 33b62df3 4f1e2491 ef8c5824 f8a80cd8 6e65193a

   y':  0x00 951682f0 10b08932 b28b4a85 1ec79469 f9437fc4 f9cfa8cc
      dec25c3c c847890c 65e1bcd2 df994b83 5b71e49c 0fc69e6d 9ea5da9d
      bb020a9d fb2942dd 022fa962 fb0233de 016c8c80 e9387b0b 28786785
      523e68eb 7c008f81 b99ee3b5 d10a72e5 321a09b7 4b39c58b 75d09d73
      e4155b76 dc11d8dd 416b7fa6 3557fcdd b0a955f6 f5e0028d 4af2150b
      fd757a89 8b548912 e2c0c6e5 70449113 fcee54cd a9cb8bfd 7f182825
      b371f069 61b62ca4 41bfcb3d 13ce6840 432bf8bc 4736003c 64d695e9
      84ddc2ef 4aee1747 044157fd 2f9b81c4 3eed97d3 45289899 6d24c66a
      ad191dba 634f3e04 c89485e0 6f8308b8 afaedf1c 98b1a466 deab2c15
      81f96b6f 3c64d440 f2a16a62 75000cf3 8c09453b 5b9dc827 8eabe442



Yonezawa, et al.       Expires September 12, 2019              [Page 12]

Internet-Draft           Pairing-Friendly Curves              March 2019


      92a154dc 69faa74a d76ca847 b786eb2f d686b9be 509fe24b 8293861c
      c35d76be 88c27117 04bfe118 e4db1fad 86c2a642 4da6b3e5 807258a2
      d166d3e0 e43d15e3 b6464fb9 9f382f57 fd10499f 8c8e11df 718c98a0
      49bd0e5d 1301bc9e 6ccd0f06 3b06eb06 422afa46 9b5b529b 8bba3d4c
      6f219aff e4c57d73 10a92119 c98884c3 b6c0bbcc 113f6826 b3ae70e3
      bbbaadab 3ff8abf3 b905c231 38dfe385 134807fc c1f9c19e 68c0ec46
      8213bc9f 0387ca1f 4ffe406f da92d655 3cd4cfd5 0a2c895e 85fe2540
      9ffe8bb4 3b458f9b efab4d59 bee20e2f 01de48c2 affb03a9 7ceede87
      214e3bb9 0183303b 672e50b8 7b36a615 34034578 db0195fd 81a46beb
      55f75d20 049d044c 3fa5c367 8c783db3 120c2580 359a7b33 cac5ce21
      e4cecda9 e2e2d6d2 ff202ff4 3c1bb2d4 b5e53dae 010423ce

   h':  0x170e915c b0a6b740 6b8d9404 2317f811 d6bc3fc6 e211ada4 2e58ccfc
      b3ac076a 7e4499d7 00a0c23d c4b0c078 f92def8c 87b7fe63 e1eea270
      db353a4e f4d38b59 98ad8f0d 042ea24c 8f02be1c 0c83992f e5d77252
      27bb2712 3a949e08 76c0a8ce 0a67326d b0e955dc b791b867 f31d6bfa
      62fbdd5f 44a00504 df04e186 fae033f1 eb43c1b1 a08b6e08 6eff03c8
      fee9ebdd 1e191a8a 4b0466c9 0b389987 de5637d5 dd13dab3 3196bd2e
      5afa6cd1 9cf0fc3f c7db7ece 1f3fac74 2626b1b0 2fcee040 43b2ea96
      492f6afa 51739597 c54bb78a a6b0b993 19fef9d0 9f768831 018ee656
      4c68d054 c62f2e0b 4549426f ec24ab26 957a669d ba2a2b69 45ce40c9
      aec6afde da16c79e 15546cd7 771fa544 d5364236 690ea068 32679562
      a6873142 0ae52d0d 35a90b8d 10b688e3 1b6aee45 f45b7a50 83c71732
      105852de cc888f64 839a4de3 3b99521f 0984a418 d20fc7b0 609530e4
      54f0696f a2a8075a c01cc8ae 3869e8d0 fe1f3788 ffac4c01 aa2720e4
      31da333c 83d9663b fb1fb7a1 a7b90528 482c6be7 89229903 0bb51a51
      dc7e91e9 15687441 6bf4c26f 1ea7ec57 80585639 60ef92bb bb8632d3
      a1b695f9 54af10e9 a78e40ac ffc13b06 540aae9d a5287fc4 429485d4
      4e6289d8 c0d6a3eb 2ece3501 24527518 39fb48bc 14b51547 8e2ff412
      d930ac20 307561f3 a5c998e6 bcbfebd9 7effc643 3033a236 1bfcdc4f
      c74ad379 a16c6dea 49c209b1

   b':  -1 / w

5.  Implementations of Pairing-Friendly Curves

   We show the pairing-friendly curves selected by existing standards,
   applications and cryptographic libraries.

   ISO/IEC 15946-5 [33] shows examples of BN curves with the size of
   160, 192, 224, 256, 384 and 512 bits of p.  There is no action so far
   after the proposal of exTNFS.

   TCG adopts an BN curve of 256 bits specified in ISO/IEC 15946-5
   (TPM_ECC_BN_P256) and of 638 bits specified by their own
   (TPM_ECC_BN_P638).  FIDO Alliance [20] and W3C [21] adopt the BN
   curves specified in TCG, a 512-bit BN curve shown in ISO/IEC 15946-5
   and another 256-bit BN curve.



Yonezawa, et al.       Expires September 12, 2019              [Page 13]

Internet-Draft           Pairing-Friendly Curves              March 2019


   MIRACL [34] implements BN curves and BLS12 curves.

   Zcash implemented a BN curve (named BN128) in their library libsnark
   [35].  After exTNFS, they propose a new parameter of BLS12 as
   BLS12-381 [32] and publish its experimental implementation [36].

   Cloudflare implements a 256-bit BN curve (bn256) [37].  There is no
   action so far after exTNFS.

   Ethereum 2.0 adopts BLS12-381 (BLS12_381), BN curves with 254 bits of
   p (CurveFp254BNb) and 382 bits of p (CurveFp382_1 and CurveFp382_2)
   [38].  Their implementation calls mcl [30] for pairing computation.

   Cryptographic libraries which implement pairings include PBC [39],
   mcl [30], RELIC [40], TEPLA [41], AMCL [42], Intel IPP [43] and a
   library by Kyushu University [44].

   Table 1 shows the adoption of pairing-friendly curves in existing
   standards, applications and libraries.  In this table, the curves
   marked as (*) indicate that there is no research result on the
   security evaluation, but that the implementers states that they hold
   128 bits of security.





























Yonezawa, et al.       Expires September 12, 2019              [Page 14]

Internet-Draft           Pairing-Friendly Curves              March 2019


   +--------------+------------+--------------+----------------+-------+
   | Category     | Name       | 100 bit      | 128 bit        | 256   |
   |              |            |              |                | bit   |
   +--------------+------------+--------------+----------------+-------+
   | standards    | ISO/IEC    | BN256        | BN384          |       |
   |              | [33]       |              |                |       |
   |              |            |              |                |       |
   |              | TCG        | BN256        |                |       |
   |              |            |              |                |       |
   |              | FIDO/W3C   | BN256        |                |       |
   |              |            |              |                |       |
   | applications | MIRACL     | BN254        | BLS12          |       |
   |              |            |              |                |       |
   |              | Zcash      | BN128        | BLS12-381      |       |
   |              |            | (CurveSNARK) |                |       |
   |              |            |              |                |       |
   |              | Cloudflare | BN256        |                |       |
   |              |            |              |                |       |
   |              | Ethereum   | BN254        | BN382 (*) /    |       |
   |              |            |              | BLS12-381 (*)  |       |
   |              |            |              |                |       |
   | libraries    | PBC        | BN           |                |       |
   |              |            |              |                |       |
   |              | mcl        | BN254 /      | BN381_1 (*) /  |       |
   |              |            | BN_SNARK1    | BN462 /        |       |
   |              |            |              | BLS12-381      |       |
   |              |            |              |                |       |
   |              | RELIC [40] | BN254 /      | BLS12-381 /    |       |
   |              |            | BN256        | BLS12-455      |       |
   |              |            |              |                |       |
   |              | TEPLA      | BN254        |                |       |
   |              |            |              |                |       |
   |              | AMCL       | BN254 /      | BLS12-381 (*)  | BLS48 |
   |              |            | BN256        | / BLS12-383    |       |
   |              |            |              | (*) /          |       |
   |              |            |              | BLS12-461      |       |
   |              |            |              |                |       |
   |              | Intel IPP  | BN256        |                |       |
   |              |            |              |                |       |
   |              | Kyushu     |              |                | BLS48 |
   |              | Univ.      |              |                |       |
   +--------------+------------+--------------+----------------+-------+

               Table 1: Adoption of Pairing-Friendly Curves







Yonezawa, et al.       Expires September 12, 2019              [Page 15]

Internet-Draft           Pairing-Friendly Curves              March 2019


6.  Security Considerations

   This memo entirely describes the security of pairing-friendly curves,
   and introduces secure parameters of pairing-friendly curves.  We give
   these parameters in terms of security, efficiency and global
   acceptance.  The parameters for 100, 128 and 256 bits of security are
   introduced since the security level will different in the
   requirements of the pairing-based applications.

7.  IANA Considerations

   This document has no actions for IANA.

8.  Acknowledgements

   The authors would like to thank Akihiro Kato for his significant
   contribution to the early version of this memo.

9.  Change log

10.  References

10.1.  Normative References

   [1]        Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/info/rfc2119>.

   [2]        Vercauteren, F., "Optimal Pairings", IEEE Transactions on
              Information Theory Vol. 56, pp. 455-461,
              DOI 10.1109/tit.2009.2034881, January 2010.

   [3]        Barreto, P. and M. Naehrig, "Pairing-Friendly Elliptic
              Curves of Prime Order", Selected Areas in Cryptography pp.
              319-331, DOI 10.1007/11693383_22, 2006.

   [4]        Barreto, P., Lynn, B., and M. Scott, "Constructing
              Elliptic Curves with Prescribed Embedding Degrees",
              Security in Communication Networks pp. 257-267,
              DOI 10.1007/3-540-36413-7_19, 2003.

   [5]        Kim, T. and R. Barbulescu, "Extended Tower Number Field
              Sieve: A New Complexity for the Medium Prime Case",
              Advances in Cryptology - CRYPTO 2016 pp. 543-571,
              DOI 10.1007/978-3-662-53018-4_20, 2016.





Yonezawa, et al.       Expires September 12, 2019              [Page 16]

Internet-Draft           Pairing-Friendly Curves              March 2019


   [6]        Barbulescu, R. and S. Duquesne, "Updating Key Size
              Estimations for Pairings", Journal of Cryptology,
              DOI 10.1007/s00145-018-9280-5, January 2018.

   [7]        Menezes, A., Sarkar, P., and S. Singh, "Challenges with
              Assessing the Impact of NFS Advances on the Security of
              Pairing-Based Cryptography", Lecture Notes in Computer
              Science pp. 83-108, DOI 10.1007/978-3-319-61273-7_5, 2017.

   [8]        Kiyomura, Y., Inoue, A., Kawahara, Y., Yasuda, M., Takagi,
              T., and T. Kobayashi, "Secure and Efficient Pairing at
              256-Bit Security Level", Applied Cryptography and Network
              Security pp. 59-79, DOI 10.1007/978-3-319-61204-1_4, 2017.

10.2.  Informative References

   [9]        Boyen, X. and L. Martin, "Identity-Based Cryptography
              Standard (IBCS) #1: Supersingular Curve Implementations of
              the BF and BB1 Cryptosystems", RFC 5091,
              DOI 10.17487/RFC5091, December 2007,
              <https://www.rfc-editor.org/info/rfc5091>.

   [10]       Groves, M., "Sakai-Kasahara Key Encryption (SAKKE)",
              RFC 6508, DOI 10.17487/RFC6508, February 2012,
              <https://www.rfc-editor.org/info/rfc6508>.

   [11]       Cakulev, V., Sundaram, G., and I. Broustis, "IBAKE:
              Identity-Based Authenticated Key Exchange", RFC 6539,
              DOI 10.17487/RFC6539, March 2012,
              <https://www.rfc-editor.org/info/rfc6539>.

   [12]       Groves, M., "MIKEY-SAKKE: Sakai-Kasahara Key Encryption in
              Multimedia Internet KEYing (MIKEY)", RFC 6509,
              DOI 10.17487/RFC6509, February 2012,
              <https://www.rfc-editor.org/info/rfc6509>.

   [13]       3GPP, "Security of the mission critical service (Release
              15)", 3GPP TS 33.180 15.3.0, 2018.

   [14]       ISO/IEC, "ISO/IEC 11770-3:2015", ISO/IEC Information
              technology -- Security techniques -- Key management --
              Part 3: Mechanisms using asymmetric techniques, 2015.

   [15]       Joux, A., "A One Round Protocol for Tripartite Diffie-
              Hellman", Lecture Notes in Computer Science pp. 385-393,
              DOI 10.1007/10722028_23, 2000.





Yonezawa, et al.       Expires September 12, 2019              [Page 17]

Internet-Draft           Pairing-Friendly Curves              March 2019


   [16]       Chen, L., Cheng, Z., and N. Smart, "Identity-based key
              agreement protocols from pairings", International Journal
              of Information Security Vol. 6, pp. 213-241,
              DOI 10.1007/s10207-006-0011-9, January 2007.

   [17]       Fujioka, A., Suzuki, K., and B. Ustao&#287;lu, "Ephemeral
              Key Leakage Resilient and Efficient ID-AKEs That Can Share
              Identities, Private and Master Keys", Lecture Notes in
              Computer Science pp. 187-205,
              DOI 10.1007/978-3-642-17455-1_12, 2010.

   [18]       Scott, M., "M-Pin: A Multi-Factor Zero Knowledge
              Authentication Protocol", March 2019,
              <https://www.miracl.com/miracl-labs/m-pin-a-multi-factor-
              zero-knowledge-authentication-protocol>.

   [19]       Trusted Computing Group (TCG), "Trusted Platform Module
              Library Specification, Family \"2.0\", Level 00, Revision
              01.38", <https://trustedcomputinggroup.org/resource/
              tpm-library-specification/>.

   [20]       Lindemann, R., "FIDO ECDAA Algorithm - FIDO Alliance
              Review Draft 02", <https://fidoalliance.org/specs/
              fido-v2.0-rd-20180702/
              fido-ecdaa-algorithm-v2.0-rd-20180702.html>.

   [21]       Lundberg, E., "Web Authentication: An API for accessing
              Public Key Credentials Level 1 - W3C Candidate
              Recommendation", <https://www.w3.org/TR/webauthn/>.

   [22]       Lindemann, R., "What are zk-SNARKs?",
              <https://z.cash/technology/zksnarks.html>.

   [23]       Sullivan, N., "Geo Key Manager: How It Works",
              <https://blog.cloudflare.com/
              geo-key-manager-how-it-works/>.

   [24]       Williams, D., "DFINITY Technology Overview Series
              Consensus System Rev. 1", n.d., <https://dfinity.org/pdf-
              viewer/library/dfinity-consensus.pdf>.

   [25]       Jordan, R., "Ethereum 2.0 Development Update #17 -
              Prysmatic Labs", <https://medium.com/prysmatic-labs/
              ethereum-2-0-development-update-17-prysmatic-labs-
              ed5bcf82ec00>.

   [26]       ECRYPT, "Final Report on Main Computational Assumptions in
              Cryptography".



Yonezawa, et al.       Expires September 12, 2019              [Page 18]

Internet-Draft           Pairing-Friendly Curves              March 2019


   [27]       Pollard, J., "Monte Carlo methods for index computation
              $({\rm mod}\ p)$", Mathematics of Computation Vol. 32, pp.
              918-918, DOI 10.1090/s0025-5718-1978-0491431-9, September
              1978.

   [28]       Hellman, M. and J. Reyneri, "Fast Computation of Discrete
              Logarithms in GF (q)", Advances in Cryptology pp. 3-13,
              DOI 10.1007/978-1-4757-0602-4_1, 1983.

   [29]       Barreto, P., Costello, C., Misoczki, R., Naehrig, M.,
              Pereira, G., and G. Zanon, "Subgroup Security in Pairing-
              Based Cryptography", Progress in Cryptology -- LATINCRYPT
              2015 pp. 245-265, DOI 10.1007/978-3-319-22174-8_14, 2015.

   [30]       Mitsunari, S., "mcl - A portable and fast pairing-based
              cryptography library", 2016,
              <https://github.com/herumi/mcl>.

   [31]       "IEEE Standard Specifications for Public-Key Cryptography
              - Amendment 1: Additional Techniques", IEEE standard,
              DOI 10.1109/ieeestd.2004.94612, n.d..

   [32]       Bowe, S., "BLS12-381: New zk-SNARK Elliptic Curve
              Construction", <https://blog.z.cash/new-snark-curve/>.

   [33]       ISO/IEC, "ISO/IEC 15946-5:2017", ISO/IEC Information
              technology -- Security techniques -- Cryptographic
              techniques based on elliptic curves -- Part 5: Elliptic
              curve generation, 2017.

   [34]       MIRACL Ltd., "MIRACL Cryptographic SDK", 2018,
              <https://github.com/miracl/MIRACL>.

   [35]       SCIPR Lab, "libsnark: a C++ library for zkSNARK proofs",
              2012, <https://github.com/zcash/libsnark>.

   [36]       zkcrypto, "zkcrypto - Pairing-friendly elliptic curve
              library", 2017, <https://github.com/zkcrypto/pairing>.

   [37]       Cloudflare, "package bn256", March 2019,
              <https://godoc.org/github.com/cloudflare/bn256>.

   [38]       Prysmatic Labs, "go-bls - Go wrapper for a BLS12-381
              Signature Aggregation implementation in C++", 2018,
              <https://godoc.org/github.com/prysmaticlabs/go-bls>.

   [39]       Lynn, B., "PBC Library - The Pairing-Based Cryptography
              Library", 2006, <https://crypto.stanford.edu/pbc/>.



Yonezawa, et al.       Expires September 12, 2019              [Page 19]

Internet-Draft           Pairing-Friendly Curves              March 2019


   [40]       Gouv, C., "RELIC is an Efficient LIbrary for
              Cryptography", 2013,
              <https://code.google.com/p/relic-toolkit/>.

   [41]       University of Tsukuba, "TEPLA: University of Tsukuba
              Elliptic Curve and Pairing Library", 2013,
              <http://www.cipher.risk.tsukuba.ac.jp/tepla/index_e.html>.

   [42]       The Apache Software Foundation, "The Apache Milagro
              Cryptographic Library (AMCL)", 2016,
              <https://github.com/apache/incubator-milagro-crypto>.

   [43]       Intel Corporation, "Developer Reference for Intel
              Integrated Performance Primitives Cryptography 2019",
              2018, <https://software.intel.com/en-us/ipp-crypto-
              reference-arithmetic-of-the-group-of-elliptic-curve-
              points>.

   [44]       Kyushu University, "bls48 - C++ library for Optimal Ate
              Pairing on BLS48", 2017,
              <https://github.com/mk-math-kyushu/bls48>.

Appendix A.  Computing Optimal Ate Pairing

   Before presenting the computation of optimal Ate pairing e(P, Q)
   satisfying the properties shown in Section 2.2, we give subfunctions
   used for pairing computation.

   The following algorithm shows the computation of the line function.
   It takes A = (A[1], A[2]), B = (B[1], B[2]) in G_2 and P = ((P[1],
   P[2])) in G_1 as input and outputs an element of G_T.

       if (A = B) then
           l := (3 * A[1]^2) / (2 * A[2]);
       else if (A = -B) then
           return P[1] - A[1];
       else
           l := (B[2] - A[2]) / (B[1] - A[1]);
       end if;
       return (l * (P[1] -A[1]) + A[2] -P[2]);

   When implementing the line function, implementer should consider the
   isomorphism of E and its twisted curve E' so that one can reduce the
   computational cost of operations in G_2.  We note that the function
   Line_function does not consider such isomorphism.






Yonezawa, et al.       Expires September 12, 2019              [Page 20]

Internet-Draft           Pairing-Friendly Curves              March 2019


   Computation of optimal Ate pairing for BN curves uses Frobenius map.
   Let a Frobenius map pi for a point Q = (x, y) over E' be pi(p, Q) =
   (x^p, y^p).

A.1.  Optimal Ate Pairings over Barreto-Naehrig Curves

   Let s = 6u + 2 for a parameter u and s_0, s_1, ... , s_l in {-1,0,1}
   such that the sum of s_i * 2^i (i = 0, 1, ..., L) equals to s.

   The following algorithm shows the computation of optimal Ate pairing
   over Barreto-Naehrig curves.  It takes P in G_1, Q in G_2, an integer
   s, s_0, ...,s_L in {-1,0,1} such that the sum of s_i * 2^i (i = 0, 1,
   ..., L) equals to s, and an order r as input, and outputs e(P, Q).

       f := 1; T := Q;
       if (s_L = -1)
           T := -T;
       end if
       for i = L-1 to 0
           f := f^2 * Line_function(T, T, P); T := 2 * T;
           if (s_i = 1 | s_i = -1)
               f := f * Line_function(T, s_i * Q); T := T + s_i * Q;
           end if
       end for
       Q_1 := pi(p, Q); Q_2 := pi(p, Q_1);
       f := f * Line_function(T, Q_1, P); T := T + Q_1;
       f := f * Line_function(T, -Q_2, P);
       f := f^{(p^k - 1) / r}
       return f;

A.2.  Optimal Ate Pairings over Barreto-Lynn-Scott Curves

   Let u_0, u_1, ... , u_l in {-1,0,1} be a sign-digit representation of
   a parameter u such that the sum of u_i * 2^i (i = 0, 1, ..., L)
   equals to u.  The following algorithm shows the computation of
   optimal Ate pairing over Barreto-Naehrig curves.  It takes P in G_1,
   Q in G_2, a parameter u, u_0, u_1, ..., u_L in {-1,0,1} such that the
   sum of u_i * 2^i (i = 0, 1, ..., L), and an order r as input, and
   outputs e(P, Q).












Yonezawa, et al.       Expires September 12, 2019              [Page 21]

Internet-Draft           Pairing-Friendly Curves              March 2019


       f := 1; T := Q;
       if (u_L = -1)
           T := -T;
       end if
       for i = L-1 to 0
           f := f^2 * Line_function(T, T, P); T := 2 * T;
           if (u_i = 1 | u_i = -1)
               f := f * Line_function(T, s_i * Q, P); T := T + s_i * Q;
           end if
       end for
       f := f^{(p^k - 1) / r};
       retern f;

Appendix B.  Test Vectors of Optimal Ate Pairing

   We provide test vectors for Optimal Ate Pairing e(P, Q) given in
   Appendix A for the curves BN462, BLS12-381 and BLS48-581 given in
   Section 4.

   BN462:

   Input P value:  (TBD)

   Input Q value:  (TBD)

   Output e(P, Q):  0x3C8193BE D979F4EA 5012851F 2EB824BA 7D21F584
      5C041641 0F26A097 72AB76E9 153AD0DF 012C6AAD B90B2DB7 91B4865D
      C0DCE2A1 DEEC6844 03BC919A 350D0077 25F4AAF2 EB1C6A6A 84C3D68B
      3EB71C8F 6D21A669 6D3B70B8 2AB34CA3 D8E362F8 570AEEC9 78D92761
      54940920 D459438E 2141831F E6813BDA 88F0A239 D693499F 07806C58
      8498A881 870A313A 26C03629 44F48955 25034B30 BECB184D 52E0D806
      62215750 4C392059 308A3AB6 0F567FCE 39169B96 36932988 ABB8689F
      709A4AD2 6EBC8DC2 65F79386 19357015 CF8AEBEC 069412B8 82DD79BF
      112713EC 241D5E20 D6003B61 4943D666 403CB445 8E4AC7B8 800873EB
      55D6E5AA BB6398C1 C0F349F0 9E4BA501 F239E3F5 4D09AD61 40452545
      F07A20D5 3D075B26 30FEFB61 F46EAE73 4A0098C1 B7B7BAF5 33A6072A
      5E288590 CFB0C85B 4EDF7BE9 06E01B4F 023387D8 5E9CA9AA 70EC3B5C
      C1ACB450 685F4134 5391A237 182295B9 FE23EBBB F8485065 DA74C4A5
      91A01F3E 5E3C5710 337C050B 01C17724 D7CC02B4 F0F512DA 2AF14526
      0028235D E26FE897 7BC0A2E5 7C183729 661ED63F AEF45700 78E30F16
      D09E1C58 888E561D A1CB4ADB 1390360D D8D7B7B5 F097B0E0 7C988743
      001EB5D1 50DA6218 428C960F 10441667 E4CE905C E9CB9176 987E1731
      403181B2 D197C267 27F8FEF0 0A612956 A43B172F EA11BA6F 660BE51F
      12C1F80A 3697B28B 4D685AB6 7816E4B9 A8265A21 825A059D B092CFC1
      CC28D142 8988B01A 3EC9A14B 8B95BF1D 3D111BE3 82848F2C 1E9AE9FE
      DBEFB52E 8EBA88EA 17AD2E37 30BA6D0E FCD916DE 43C1666F 3B25CD7F
      E72147F4 5E6C55CC 701A6469 1426D6CD 9FBBE831 6A00537A 53650496
      D27C2819 4B5C1D2C 4909BCF0 06AB5E0F 90FD82A1 4E45C5D0 08448080



Yonezawa, et al.       Expires September 12, 2019              [Page 22]

Internet-Draft           Pairing-Friendly Curves              March 2019


      154B4723 B44BBC0D 48911427 DBC54E0C 0D41A043 6A1C2D36 252B921A
      2560DDCC AD362CB9 02F79D7F 1210DDAC 950BF406 D0F0C79F 299BCEBD

   BLS12-381:

   Input P value:  (TBD)

   Input Q value:  (TBD)

   Output e(P, Q):  0x1099133 07699946 FFB01BB6 A8708EFD AE7A380D
      3D0EEED9 B73440E4 6BA128C4 DB75A7B2 1DF4CABB A9722393 01955454
      F8E43F34 37F83953 557F251D 93C11E38 91134DA9 E9D0A017 DB6BBEF8
      F9F00689 B05A4E7B 66CA3B5E BD345258 F776E9E1 117E41EC 69120956
      0E0AC469 921183F4 76C8DC14 0D30C301 A7A673E4 FC51655E 0C4130E5
      47E1F648 386A1555 7AB73DD7 B113EE92 60869568 7DD9CB79 5060647E
      FEAC9894 C0049AB3 4F1CBDEA C9527013 EF5810EC F5672692 74A0425A
      FF778592 49FDD23A AF67E366 5C40A2B9 4A0AAE91 112FB6AA D05AC5CA
      8E3FA0BC 6B185C94 447D2368 136BA383 BBEC5528 AF53F298 1628BA4B
      906E54F0 60383B92 FC46F84E 2E7C50D7 9CF7FF6D 21E81A67 15B31A66
      0AA418EA DE81887E C995285A 656D0A43 208EF518 27FD935A 1D617142
      AD008F36 15201E00 017154AC 5AEE4C2D AA96433F 97CC4705 59F94D64
      DCF4C69C FC254475 D1365BC4 A3D18524 BE1F6A7A CD1AD2E6 4A901E5C
      F97C6291 EFA4951C DBA232E2 172C7E94 4C89F6FC F6074D23 F41EA7ED
      783BE9BA ACE67AE2 7E9C682F D8FC347E 533D5E2E 550B72EE EE9F250F
      427AC1F1 A0BB315E E5582635 065EC196 F68776AB 97CDD86E 9F1117B3
      873800A1 9C2221C9 3A810A71 7FB6AE09 A8EAC52D 707158C7 83D45B9E
      EC3ADFA8 3B626448 60679B2E E242888D C0AE8C3F 7A4E2C5F 8D9060B8
      4B7C53C2 3992B502 15170D86 A8A1A1E6 2737E951 647CE587 2379CC01
      AB977532 CEFDDF85 39A8223F 3DF88ACC DD1C9FA2 C66227B9 5549471B
      462370AA 61B58C57 E9035EF9 0D630357 D852EAA3

   BLS48-581:

   Input P value:  (TBD)

   Input Q value:  (TBD)

   Output e(P, Q):  0x276 43363D8D 5BCD15F0 B28C5097 EEF37DE3 71C67B59
      9C1EDB17 6719754F F47A6EA7 5AD80480 617A2769 333ED4D1 89C7E90B
      36A7F3C9 873A13AF F7CD1604 7A3C7FDC BF0C8471 BB510164 94C2E075
      1DA368ED 41B9C2AE 12694B36 3ABC6E6E 4F179278 71D4D68D B391F9BE
      D8DF5283 1E6EFE0A FA3816FD 8387CA11 5D2CBA0C 16A34759 0CEA2FA9
      D358712D CF6C023A D4F5DFB9 FFD8CB2E 2778E6F6 95185E58 E2D81C2F
      0CEBCC27 0E0FAE67 8F758EF6 E319D634 F860A03F 10953E20 3C7E419F
      9EB8A0B1 AF2890B2 B4182D8A F9FCBD41 0527E637 8C1A5ACA 0EA8C085
      E2784E78 7C1E4712 FD891DC6 C20E5C72 A2B899CD 21AEDE46 358BC4C0
      17270F72 3CC29866 17FBABD4 B9C24FF7 44B9A032 1A2EBB39 2034D2AE
      4D415EB8 FD45330E 8FAE1C93 F5D8849F 558E14DC F20E60B5 19122407



Yonezawa, et al.       Expires September 12, 2019              [Page 23]

Internet-Draft           Pairing-Friendly Curves              March 2019


      CDB876B2 EB7897A8 9A602B0C 61093E87 D7DFC7C1 5CACF77A 9C71E9EA
      E43A6DFB FA4F68B8 9019F394 5CAF71C1 9682779C 533E0CE0 002C16CF
      123D3AFF B99103D0 4D3FDB2A 6A1682AB 3A34CC41 7F369850 A22DB3A6
      C5B2D34B E0E97FA1 EB9E7D6E 45431E64 E6F0D20B F725CB43 23807531
      FCA7994A 1447BB9C 1FC39FA8 87750F53 76C69ECB 8C58C70F F11A9F6D
      5F5F780A 831BE9A6 1729EE17 78F050D6 C2AFCDDA 6CAB13BD 952DE323
      222FBAEA 4638E029 5FBD5B8F 5C60EE91 429B078F 36F3DC2B E436236D
      5FD2282C FF620325 2456F683 4B9AEA62 12D9D478 DDCDB1FC 0537DB30
      5CC854F3 9ACA8619 38D0AAB5 53F0D449 F4CA5BC7 653101B8 F90B70C9
      41BBCD9E 7775F810 2009C9C4 F268E0D1 5305C287 41D048B1 78F1F8CE
      599C66AA E2401D1F 29E4987D E3D448AB B6462856 FE880511 8FE5D21A
      E5CE44BB A7EEF2AC 2CD4138A B98152A0 8028275F A08A6D3E FE9344D1
      6945016D E83C7287 FFF6B6AA 95CF2757 C27CA48E CE8B8397 DA3EB8F9
      95550853 43ABA175 5660283B 5EA74E5E 52652818 4D100002 192E2440
      61F917EF F3331617 CC10BD27 6167EC72 579A9421 40E1C538 858E84E5
      B7585B17 B0EB8BD4 5B8915D4 48BFE906 1FED09AA 7B91E299 B394CCF8
      7C5FBB4C 65ED6AB0 56F33C8B DB82AEA1 BAAD3F34 25B457E0 FE6A6193
      0D4DD22A E7E1E394 6A655C72 564B4B65 D701A680 C6CCF3FE 88A1327D
      3399523A 06E9D2AD 2ECBB9ED 9518634D 2201150F 7133381B D1311540
      2F482E17 15B68876 F448C6E0 FF0DFEC5 D3174EE8 026F7377 8692C617
      82236066 E74B7099 6FA41DAE B068C9A7 8F5D8B59 655985E0 BD6E3785
      B5846F7E 721339E6 788731C2 4B80E26D D1182223 B669AD45 35E536F3
      DF711C31 F1AA0227 18FDB6E8 B7AD06C7 64785050 7B3C6A7E 454DC498
      B86769BD 1FE57AA7 959F972E 8EDB1326 B2A4233A 5D7E34D3 2C545B92
      415B1944 3339642D 441FD7EF AB7E16EE AEBC422D 92C614C4 85E5E18E
      C3B990DB 473A2DC2 7277C5CC 408C42D8 E1615DE5 151A4EBA 594C8D98
      27F4B14E 38E3AFD1 302AA4F8 6AD4D4CE 621F5DE7 7B7F04B8 FA3CA11C
      D701EEE9 F7094AC3 24259670 5A30CCF2 DBF32491 074EE2AD E6595C11
      71CF54D1 2EBAD23E 383624B5 63C1EBA7 A76E4002 F1CDD4A0 E1F8C24E
      9227AA53 B56E077E D371BABD 5935C20C D64EA0A0 45037849 98089570
      7A54167F 68ABCC8E 06D4D4B1 027B6CDA 799CEAA2 B254B9EA 7F34A437
      8417E12A 1BEF63AC 3DD3B156 41F92E83 911AC76D 4EBFAACA BDF0F81E
      BA243180 CF9A12D4 0F188A82 2D427533 A06969E9 B15DED57 85971636
      F9F980E7 27B22628 97CCB665 A3857AB7 754C2BAC 6627A5B1 8FC419DA
      14B8BB5F 2FE3D29C 62F8BE1F BDD078D6 529087E3 002039DA 3C193038
      3D5582D2 9D061C87 D68ACF45 618F7DA2 65194F7F 02FAE405 B0C08687
      15DF1C3F AF6B71DF 7331B79C 0E9FE708 C05FF1CB 11A14B68 684A04A3
      38359484 CB994DC2 F4322928 17A1FD00 C12DAE52 F8D151C6 FE34B3DC
      C9CA7EB5 59D44BAA F58CF94F 0646C469 4C49E3F1 81E0B1FB 382056AA
      771C4118 33D7CFBF 8212BC96 EE303DFC 15623717 C814FD49 E9355F48
      A480AF44 BD7D2C94 031D9881 456A9EAB 57E43962 668F1797 3CFA0E9A
      075D94E3 DB2AD9C0 6D4A2EE8 DB81DB28 62AF5F2E AC946630 F61A8AB1
      B868469A 9F7C2886 7C45CF5D 801BBBD7 4ECF2FCE CD6C9939 865D7E27
      DBE56FBF F5321CD8 29ACF9C3 16C24778 ECC263E4 91CF8ED0 B23E1F2E
      C9BF0036 E9F4442A D14DB499 7DAF8F4D BD4E7E7D 96FA32F0 474E04AA
      DCED225E 9B723462 900CB340 9320DFD8 54181422 D8135667 897D62CC
      15A7E844 B72F713B 983E33F2 017417FC EF9D384F 58600B02 2FBD93BB
      2B405B74 896ACDC3 2B5C459A 4584AEA9 3FACF3D4 1C103D85 38FEF57A



Yonezawa, et al.       Expires September 12, 2019              [Page 24]

Internet-Draft           Pairing-Friendly Curves              March 2019


      8FF66715 F84AAB22 D6B2613C EE764038 579A5334 B212A15B 9DDC3914
      524F85A8 89ED7CAC 72BD23DF EE819CB2 073F64A1 BD7A5B30 3119A571
      5BAE052C 7B71B023 0D941D65 BD186322 7935EB6B 0B648608 D044A254
      9EDDDAE2 46F935C6 82BF9200 9FB1D1E4 204A3946 8138E0DD 73B5C451
      8C14FAF2 69B7A50D 2C187367 748AFF27 EE960EF2 92BBBCAA 86DB4F6D
      CA77DD66 1ECA3FBF BE11E012 87B40AEB 81FEA4A2 0F8870DD FC910B80
      E9FA9A7F 3949FBF9 E100C790 26256FFE 35B0B427 E9BF6364 616B3E44
      45BA35FC 3C65C442 49544AEA 848B2577 8A7D3CED 9A3393CF 6AAB49F7
      337CDA34 DFA94FB7 6283645F 7551A49F 0FC0960D B6538505 374BC05E
      BA88344A 27710517 00AAED45 6EBE28D2 F987AC36 3DD8A339 5617100C
      00355AD3 0A22CD13 34E32157 BE954065 4FA2841E B370760F 182D8D8F
      11380D0D D358C2BE B3C2A9B1 C791A142 36DEC80D EAABF2FA D5076703
      649C4C67 091E366C 593D5AD7 63598A8A 64BB95C9 1C5D4C1C F3941094
      9BC3E0AE 5EAA0E4C AFB2E520 3DA18549 5F81C36E 309E807A D6B5679B
      1978BA41 582C3C75 0D703E95 D77E479D 433867D0 FBE6C074 51984815
      0FCEC435 1C912DED 64844BF1 E2E966FA F64C520E 89517FA9 2996536A
      F096C440 7DA5C1B1 BEE0F040 CB440D00 95FB43A3 E1EE5846 CCDB0E06
      8A8086C0 3C2668AB E161554E FB4F0B19 75DF1D81 8CD38614 2E343186
      162CCE43 C9D05212 DDCAD50E 10BDD365 9007F156 DCFD40E2 7B36BAEF
      4CD5184B 71F5C342 BF3B39E3 D0F145F6 515F2EED B926C999 53AF0491
      68376477 632B7435 5D180B72 109E4049 323D0517 67EC3B58 58C545D8
      ED85E074 C839558E EFAECFEA 112062BB 9E000D82 2FAD823C 2F59387A
      62687738 FB74C5E1 24B75FC6 384BD4E9 450AD801 DB149C4E 89A02A14
      45504E84 E9D44B83 04CE52EA 513E923E 40C833EE 663A23FC 64365CC3
      EF8ABECD E2C35900 9712DEC9 511E11E2 82685A62 5580CE56 E517AB30
      10CC21D2 B4A656E3 A5BABB90 0A1678EE EF9AD5A0 46A8CF8E D82C25B4
      29C08D2F F6F3F515 7D589D84 230378A4 5649DE30 2DDB5DA6 B05790DF
      8FE450E7 BC583ABC 7AAA9B83 1FA93A64 A12C379A F6CAB1C9 A6CDF3EA
      44A651CE C8D9F607 AB050904 5C6583C3 C3827C0B 990C4D93 63139193
      CBDF158A 50B8F989 166865DB BB6D6658 7B7F2785 F2FD4810 CEB085AF
      5CABC661 2E5544F1 D0DE7CEB A1803095 03E62544 9749619C 619DD15E
      190F46BF 75788250 304F3214 460ACD9B A78D1626 B75EBEEB 8F08B9D1
      CB6183D1 FCF37B1F FF2CD490 9B05070C CF3D2275 266A42A3 1E5204D1
      55CE1587 7CD4E0C6 AFA46A05 50BE923F 66B6BE18 93383DD7 9D231D99
      7FA9A89D 039B96F0 A3BB28D9 8080706F DD87EBBA FFD5199A A5C0A01E
      351C6D9E 4A93C3CD 4BC9EEBA AFB0BFFE 7D9E2D79 6979DEDC 16D9964A
      449DE47C A4B04DB2 A192E96E 396ED228 6C8CFC6D 584DBBEA B100D82E
      97BA3C88 E29A2E56 3E30760D B21AE180 EF884967 22AC5DE8 77B85A80
      5BECAF51 F0CF000E 27FC525D 2F665471 911153A6 D19CBC50 70C8404B
      FDE12034 254A1AB0 38D6626D C83E9652 B497CFEC 9485A9EC 756B7C87
      0995DE42 0E12B91C DC8664E4 1C760C71 D519381E EBC66A31 5B21429D
      11591A5D 6994ABB8 D2F511C6 4F500FBE 7EAEA507 B7492584 9338BE99
      84388212 4A2C7DEA C03FF2B8 B53E0459 DCF41296 E5A8574D C008F089
      F47938C2 789367C5 E27FC634 434A331C 8A227B49 B31EE9EC 5425407E
      2C108F12 7CA8324C F96DCE1A 3227F6EC 4AEA2D9B AFA8C2E3 3DE6B323
      76C2F324 A351E867 8E552AB8 077D1294 EC0954D2 B134CDDC F2937952
      A2C27F6A 5CB719B6 A14C3908 4095B5D4 2AE8FCE2 A7A13A1D B1D9C7B2
      E1E07C0E 7DBDE19C 62C5EB6B 030FAA55 C33B202A 56C15DD9 9FC289E1



Yonezawa, et al.       Expires September 12, 2019              [Page 25]

Internet-Draft           Pairing-Friendly Curves              March 2019


      4F33BA8B B68C36B0 944C14EF 52CC4078 426DDBA5 ABB05F32 05882C64
      4ADB6FBE 0FE6B192 0F505B4A B163DEF7 8363D152 CA8855AD F93A84BC
      D7743570 328AC022 CB287205 8F84E35D 416CB7D6 5A6A5A6C 26C54747
      7A86DFA6 C3F59DBB E3D1208C C3157177 7AF026B2 4F8AAB6C 167F6A60
      4708E34A 15C77C9C 5C1BF246 F287A8AB 4F128CF4 8F84CB96 43DF8F6E
      EE07DE97 31C1B614 93A07041 B844E507 F8371476 D544C111 8553B3D6
      C5BBFEA5 89E4939F 1A0786CB B3432AA8 23DD8B1F 360E5761 48AACD5D
      859F8C6D B4D9EAD2 5DE7E396 2CFD47CD 40B33D31 51E1AB08 F521047A
      51046218 78A246B5 A0A675E6 D4C3315D 18A39DC8 456759FB B9A6BDA2
      CC73E391 D050B7DD 4C1A2D73 E07B32FB E7201194 AC67C827 570C17F3
      ADD5E58E D5951B91 64483445 D8C448AB 486DDE3A C677443B 6BA8F7AC
      F2617058 B65500A2 3CAF76D8 3E0211D1 966B89A5 5A8DFAEC C979A05B
      DB64C10B AA802DAA FB1CEDEB D8EB3BBF 3EDA50E5 A1E97398 B1E7112C
      D2D29D8E B71D66AD 1D39F85A F41DA1CD 3A3330FC 8C7ADFCC 91A13CE5
      AB5B29CF 0EB2CC0D 747FE5F1 588E10D1 BE6ED505 2CF5BA84 A9FF273C
      7B14C176 3DE0B128 F1A37CF7 46B27933 880550C2 56A0AC85 49A52EF3
      FC0BC8A3 EED01024 DDFFE6FC 75D8E8EE 2FC302D4 AA3F556D C16852CB
      53A373A7 555B99A1 E914CBF8 55DA764C

Authors' Addresses

   Shoko Yonezawa
   Lepidum

   Email: yonezawa@lepidum.co.jp


   Sakae Chikara
   NTT TechnoCross

   Email: chikara.sakae@po.ntt-tx.co.jp


   Tetsutaro Kobayashi
   NTT

   Email: kobayashi.tetsutaro@lab.ntt.co.jp


   Tsunekazu Saito
   NTT

   Email: saito.tsunekazu@lab.ntt.co.jp








Yonezawa, et al.       Expires September 12, 2019              [Page 26]
